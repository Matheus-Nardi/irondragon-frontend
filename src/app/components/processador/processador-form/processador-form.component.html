<h1>Cadastro de Processador</h1>

<mat-card>
  <mat-card-content>
    <form [formGroup]="formGroup">
      <mat-card-title>Informações Básicas</mat-card-title>

      <div class="grid-container">
        <!-- Coluna 1 -->
        <div class="column">
          <mat-form-field appearance="outline" class="full-width-input">
            <mat-label>Nome</mat-label>
            <input
              matInput
              type="text"
              formControlName="nome"
              placeholder="Nome do processador"
              [value]="formGroup.get('nome')?.value"
            />
            @if (formGroup.get('nome')?.value) {
            <button
              matSuffix
              mat-icon-button
              aria-label="Clear"
              (click)="formGroup.get('nome')?.setValue('')"
            >
              <mat-icon>close</mat-icon>
            </button>
            }
            <mat-error
              *ngIf="
                formGroup.get('nome')?.errors && formGroup.get('nome')?.touched
              "
            >
              {{ getErrorMessage("nome", formGroup.get("nome")?.errors) }}

              @if(formGroup.get('nome')?.hasError('apiError')) {
              <span>{{ formGroup.get("nome")?.getError("apiError") }}</span>
              }
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width-input">
            <mat-label>Socket</mat-label>
            <input
              matInput
              type="text"
              formControlName="socket"
              placeholder="Socket do processador"
              [value]="formGroup.get('socket')?.value"
            />
            @if (formGroup.get('socket')?.value) {
            <button
              matSuffix
              mat-icon-button
              aria-label="Clear"
              (click)="formGroup.get('socket')?.setValue('')"
            >
              <mat-icon>close</mat-icon>
            </button>
            }
            <mat-error
              *ngIf="
                formGroup.get('socket')?.errors && formGroup.get('socket')?.touched
              "
            >
              {{ getErrorMessage("socket", formGroup.get("socket")?.errors) }}

              @if(formGroup.get('socket')?.hasError('apiError')) {
              <span>{{ formGroup.get("socket")?.getError("apiError") }}</span>
              }
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width-input">
            <mat-label>Preço</mat-label>
            <input
              matInput
              type="text"
              formControlName="preco"
              placeholder="Preço do processador"
              [value]="formGroup.get('preco')?.value"
            />
            @if (formGroup.get('preco')?.value) {
            <button
              matSuffix
              mat-icon-button
              aria-label="Clear"
              (click)="formGroup.get('preco')?.setValue('')"
            >
              <mat-icon>close</mat-icon>
            </button>
            }
            <mat-error
              *ngIf="
                formGroup.get('preco')?.errors && formGroup.get('preco')?.touched
              "
            >
              {{ getErrorMessage("preco", formGroup.get("preco")?.errors) }}

              @if(formGroup.get('preco')?.hasError('apiError')) {
              <span>{{ formGroup.get("preco")?.getError("apiError") }}</span>
              }
            </mat-error>
          </mat-form-field>
        </div>

        <!-- Coluna 2 -->
        <div class="column">
          <mat-form-field appearance="outline" class="full-width-input">
            <mat-label>Nucleos</mat-label>
            <input
              matInput
              type="text"
              formControlName="nucleos"
              placeholder="Nucleos do processador"
              [value]="formGroup.get('nucleos')?.value"
            />
            @if (formGroup.get('nucleos')?.value) {
            <button
              matSuffix
              mat-icon-button
              aria-label="Clear"
              (click)="formGroup.get('nucleos')?.setValue('')"
            >
              <mat-icon>close</mat-icon>
            </button>
            }
            <mat-error
              *ngIf="
                formGroup.get('nucleos')?.errors &&
                formGroup.get('nucleos')?.touched
              "
            >
              {{ getErrorMessage("nucleos", formGroup.get("nucleos")?.errors) }}

              @if(formGroup.get('nucleos')?.hasError('apiError')) {
              <span>{{ formGroup.get("nucleos")?.getError("apiError") }}</span>
              }
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width-input">
            <mat-label>Threads</mat-label>
            <input
              matInput
              type="text"
              formControlName="threads"
              placeholder="Threads do processador"
              [value]="formGroup.get('threads')?.value"
            />
            @if (formGroup.get('threads')?.value) {
            <button
              matSuffix
              mat-icon-button
              aria-label="Clear"
              (click)="formGroup.get('threads')?.setValue('')"
            >
              <mat-icon>close</mat-icon>
            </button>
            }
            <mat-error
              *ngIf="
                formGroup.get('threads')?.errors &&
                formGroup.get('threads')?.touched
              "
            >
              {{ getErrorMessage("threads", formGroup.get("threads")?.errors) }}

              @if(formGroup.get('threads')?.hasError('apiError')) {
              <span>{{ formGroup.get("threads")?.getError("apiError") }}</span>
              }
            </mat-error>
          </mat-form-field>

          <div class="desbloqueado-container">
            <span>Desbloqueado</span>
            <mat-slide-toggle formControlName="desbloqueado"></mat-slide-toggle>
            <mat-error
              *ngIf="
                formGroup.get('desbloqueado')?.errors &&
                formGroup.get('desbloqueado')?.touched
              "
            >
              {{
                getErrorMessage("desbloqueado", formGroup.get("desbloqueado")?.errors)
              }}

              @if(formGroup.get('desbloqueado')?.hasError('apiError')) {
              <span>{{ formGroup.get("desbloqueado")?.getError("apiError") }}</span>
              }
            </mat-error>
          </div>
        </div>
      </div>

      <!-- Seções adicionais em layout de duas colunas -->
      <div class="grid-container">
        <!-- Coluna 1 - Frequência -->
        <div class="column">
          <div formGroupName="frequencia">
            <mat-card-title>Frequencia</mat-card-title>
            <mat-form-field appearance="outline" class="full-width-input">
              <mat-label>Clock Básico</mat-label>
              <input
                matInput
                type="text"
                formControlName="clockBasico"
                placeholder="Clock Básico"
                [value]="formGroup.get('frequencia.clockBasico')?.value"
              />
              @if (formGroup.get('frequencia.clockBasico')?.value) {
              <button
                matSuffix
                mat-icon-button
                aria-label="Clear"
                (click)="formGroup.get('frequencia.clockBasico')?.setValue('')"
              >
                <mat-icon>close</mat-icon>
              </button>
              }
              <mat-error
                *ngIf="
                  formGroup.get('frequencia.clockBasico')?.errors &&
                  formGroup.get('frequencia.clockBasico')?.touched
                "
              >
                {{
                  getErrorMessage(
                    "clockBasico",
                    formGroup.get("frequencia.clockBasico")?.errors
                  )
                }}

                @if(formGroup.get('frequencia.clockBasico')?.hasError('apiError')) {
                <span>{{
                  formGroup.get("frequencia.clockBasico")?.getError("apiError")
                }}</span>
                }
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="full-width-input">
              <mat-label>Clock Boost</mat-label>
              <input
                matInput
                type="text"
                formControlName="clockBoost"
                placeholder="Clock Boost"
                [value]="formGroup.get('frequencia.clockBoost')?.value"
              />
              @if (formGroup.get('frequencia.clockBoost')?.value) {
              <button
                matSuffix
                mat-icon-button
                aria-label="Clear"
                (click)="formGroup.get('frequencia.clockBoost')?.setValue('')"
              >
                <mat-icon>close</mat-icon>
              </button>
              }
              <mat-error
                *ngIf="
                  formGroup.get('frequencia.clockBoost')?.errors &&
                  formGroup.get('frequencia.clockBoost')?.touched
                "
              >
                {{
                  getErrorMessage(
                    "clockBoost",
                    formGroup.get("frequencia.clockBoost")?.errors
                  )
                }}

                @if(formGroup.get('frequencia.clockBoost')?.hasError('apiError')) {
                <span>{{
                  formGroup.get("frequencia.clockBoost")?.getError("apiError")
                }}</span>
                }
              </mat-error>
            </mat-form-field>
          </div>
        </div>

        <!-- Coluna 2 - Memória Cache -->
        <div class="column">
          <div formGroupName="memoriaCache">
            <mat-card-title>Memoria Cache</mat-card-title>
            <mat-form-field appearance="outline" class="full-width-input">
              <mat-label>Cache L2</mat-label>
              <input
                matInput
                type="text"
                formControlName="cacheL2"
                placeholder="Cache L2"
                [value]="formGroup.get('memoriaCache.cacheL2')?.value"
              />
              @if (formGroup.get('memoriaCache.cacheL2')?.value) {
              <button
                matSuffix
                mat-icon-button
                aria-label="Clear"
                (click)="formGroup.get('memoriaCache.cacheL2')?.setValue('')"
              >
                <mat-icon>close</mat-icon>
              </button>
              }
              <mat-error
                *ngIf="
                  formGroup.get('memoriaCache.cacheL2')?.errors &&
                  formGroup.get('memoriaCache.cacheL2')?.touched
                "
              >
                {{
                  getErrorMessage(
                    "cacheL2",
                    formGroup.get("memoriaCache.cacheL2")?.errors
                  )
                }}

                @if(formGroup.get('memoriaCache.cacheL2')?.hasError('apiError')) {
                <span>{{
                  formGroup.get("memoriaCache.cacheL2")?.getError("apiError")
                }}</span>
                }
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="full-width-input">
              <mat-label>Cache L3</mat-label>
              <input
                matInput
                type="text"
                formControlName="cacheL3"
                placeholder="Cache L3"
                [value]="formGroup.get('memoriaCache.cacheL3')?.value"
              />
              @if (formGroup.get('memoriaCache.cacheL3')?.value) {
              <button
                matSuffix
                mat-icon-button
                aria-label="Clear"
                (click)="formGroup.get('memoriaCache.cacheL3')?.setValue('')"
              >
                <mat-icon>close</mat-icon>
              </button>
              }
              <mat-error
                *ngIf="
                  formGroup.get('memoriaCache.cacheL3')?.errors &&
                  formGroup.get('memoriaCache.cacheL3')?.touched
                "
              >
                {{
                  getErrorMessage(
                    "cacheL3",
                    formGroup.get("memoriaCache.cacheL3")?.errors
                  )
                }}

                @if(formGroup.get('memoriaCache.cacheL3')?.hasError('apiError')) {
                <span>{{
                  formGroup.get("memoriaCache.cacheL3")?.getError("apiError")
                }}</span>
                }
              </mat-error>
            </mat-form-field>
          </div>
        </div>
      </div>

      <!-- Seções adicionais -->
      <div formGroupName="consumoEnergetico">
        <mat-card-title>Consumo Energético</mat-card-title>
        <div class="grid-container">
          <div class="column">
            <mat-form-field appearance="outline" class="full-width-input">
              <mat-label>Energia Básica</mat-label>
              <input
                matInput
                type="text"
                formControlName="energiaBasica"
                placeholder="Energia Básica"
                [value]="formGroup.get('consumoEnergetico.energiaBasica')?.value"
              />
              @if (formGroup.get('consumoEnergetico.energiaBasica')?.value) {
              <button
                matSuffix
                mat-icon-button
                aria-label="Clear"
                (click)="
                  formGroup.get('consumoEnergetico.energiaBasica')?.setValue('')
                "
              >
                <mat-icon>close</mat-icon>
              </button>
              }
              <mat-error
                *ngIf="
                  formGroup.get('consumoEnergetico.energiaBasica')?.errors &&
                  formGroup.get('consumoEnergetico.energiaBasica')?.touched
                "
              >
                {{
                  getErrorMessage(
                    "energiaBasica",
                    formGroup.get("consumoEnergetico.energiaBasica")?.errors
                  )
                }}

                @if(formGroup.get('consumoEnergetico.energiaBasica')?.hasError('apiError'))
                {
                <span>{{
                  formGroup
                    .get("consumoEnergetico.energiaBasica")
                    ?.getError("apiError")
                }}</span>
                }
              </mat-error>
            </mat-form-field>
          </div>
          <div class="column">
            <mat-form-field appearance="outline" class="full-width-input">
              <mat-label>Energia Máxima</mat-label>
              <input
                matInput
                type="text"
                formControlName="energiaMaxima"
                placeholder="Energia Máxima"
                [value]="formGroup.get('consumoEnergetico.energiaMaxima')?.value"
              />
              @if (formGroup.get('consumoEnergetico.energiaMaxima')?.value) {
              <button
                matSuffix
                mat-icon-button
                aria-label="Clear"
                (click)="
                  formGroup.get('consumoEnergetico.energiaMaxima')?.setValue('')
                "
              >
                <mat-icon>close</mat-icon>
              </button>
              }
              <mat-error
                *ngIf="
                  formGroup.get('consumoEnergetico.energiaMaxima')?.errors &&
                  formGroup.get('consumoEnergetico.energiaMaxima')?.touched
                "
              >
                {{
                  getErrorMessage(
                    "energiaMaxima",
                    formGroup.get("consumoEnergetico.energiaMaxima")?.errors
                  )
                }}

                @if(formGroup.get('consumoEnergetico.energiaMaxima')?.hasError('apiError'))
                {
                <span>{{
                  formGroup
                    .get("consumoEnergetico.energiaMaxima")
                    ?.getError("apiError")
                }}</span>
                }
              </mat-error>
            </mat-form-field>
          </div>
        </div>
      </div>

      <div formGroupName="conectividade">
        <mat-card-title>Conectividade</mat-card-title>
        <div class="grid-container">
          <div class="column">
            <mat-form-field appearance="outline" class="full-width-input">
              <mat-label>PCI</mat-label>
              <input
                matInput
                type="text"
                formControlName="pci"
                placeholder="PCI"
                [value]="formGroup.get('conectividade.pci')?.value"
              />
              @if (formGroup.get('conectividade.pci')?.value) {
              <button
                matSuffix
                mat-icon-button
                aria-label="Clear"
                (click)="formGroup.get('conectividade.pci')?.setValue('')"
              >
                <mat-icon>close</mat-icon>
              </button>
              }
              <mat-error
                *ngIf="
                  formGroup.get('conectividade.pci')?.errors &&
                  formGroup.get('conectividade.pci')?.touched
                "
              >
                {{
                  getErrorMessage("pci", formGroup.get("conectividade.pci")?.errors)
                }}

                @if(formGroup.get('conectividade.pci')?.hasError('apiError')) {
                <span>{{
                  formGroup.get("conectividade.pci")?.getError("apiError")
                }}</span>
                }
              </mat-error>
            </mat-form-field>
          </div>
          <div class="column">
            <mat-form-field appearance="outline" class="full-width-input">
              <mat-label>Tipo da Memória</mat-label>
              <input
                matInput
                type="text"
                formControlName="tipoMemoria"
                placeholder="Tipo da memória RAM suportada pelo processador"
                [value]="formGroup.get('conectividade.tipoMemoria')?.value"
              />
              @if (formGroup.get('conectividade.tipoMemoria')?.value) {
              <button
                matSuffix
                mat-icon-button
                aria-label="Clear"
                (click)="formGroup.get('conectividade.tipoMemoria')?.setValue('')"
              >
                <mat-icon>close</mat-icon>
              </button>
              }
              <mat-error
                *ngIf="
                  formGroup.get('conectividade.tipoMemoria')?.errors &&
                  formGroup.get('conectividade.tipoMemoria')?.touched
                "
              >
                {{
                  getErrorMessage(
                    "tipoMemoria",
                    formGroup.get("conectividade.tipoMemoria")?.errors
                  )
                }}

                @if(formGroup.get('conectividade.tipoMemoria')?.hasError('apiError'))
                {
                <span>{{
                  formGroup.get("conectividade.tipoMemoria")?.getError("apiError")
                }}</span>
                }
              </mat-error>
            </mat-form-field>
          </div>
        </div>
        <mat-form-field appearance="outline" class="full-width-input">
          <mat-label>Canais de Memoria</mat-label>
          <input
            matInput
            type="text"
            formControlName="canaisMemoria"
            placeholder="Quantidade de canais de memória"
            [value]="formGroup.get('conectividade.canaisMemoria')?.value"
          />
          @if (formGroup.get('conectividade.canaisMemoria')?.value) {
          <button
            matSuffix
            mat-icon-button
            aria-label="Clear"
            (click)="formGroup.get('conectividade.canaisMemoria')?.setValue('')"
          >
            <mat-icon>close</mat-icon>
          </button>
          }
          <mat-error
            *ngIf="
              formGroup.get('conectividade.canaisMemoria')?.errors &&
              formGroup.get('conectividade.canaisMemoria')?.touched
            "
          >
            {{
              getErrorMessage(
                "canaisMemoria",
                formGroup.get("conectividade.canaisMemoria")?.errors
              )
            }}

            @if(formGroup.get('conectividade.canaisMemoria')?.hasError('apiError'))
            {
            <span>{{
              formGroup.get("conectividade.canaisMemoria")?.getError("apiError")
            }}</span>
            }
          </mat-error>
        </mat-form-field>
      </div>

      <div class="grid-container">
        <div class="column">
          <mat-form-field appearance="outline">
            <mat-label>Fabricante</mat-label>
            <mat-select
              formControlName="fabricante"
              placeholder="Selecione um fabricante"
              [value]="formGroup.get('fabricante')?.value"
            >
            
              <mat-option
                *ngFor="let fabricante of fabricantes"
                [value]="fabricante"
              >
                {{ fabricante.nome }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="column">
          <mat-form-field appearance="outline">
            <mat-label>Placa Integrada</mat-label>
            <mat-select
              formControlName="placaIntegrada"
              placeholder="Selecione uma Placa Integrada"
              [value]="formGroup.get('placaIntegrada')?.value"
            >
              <mat-option
                *ngFor="let placaIntegrada of placasIntegradas"
                [value]="placaIntegrada"
              >
                {{ placaIntegrada.nome }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>
    </form>
  </mat-card-content>
  <mat-card-actions>
    <button mat-raised-button routerLink="/admin/processadores">
      CANCELAR
    </button>
    <button
      mat-raised-button
      color="primary"
      type="submit"
      (click)="onSubmit()"
    >
      SALVAR
    </button>
    <button
      mat-raised-button
      color="warn"
      (click)="onDelete()"
      [disabled]="formGroup.get('id')?.value === null"
    >
      EXCLUIR
    </button>
  </mat-card-actions>
</mat-card>